<?= $this->extend('landing/component/dashboard/template_exploit'); ?>
<?= $this->section('content'); ?>
<?php if (session()->getFlashdata('msg')) : ?>
    <div class="bg-blue-500 w-full border-[1px] rounded-xl p-2 my-2 text-xl text-center text-white font-bold">
        <?= session()->getFlashdata('msg'); ?>
    </div>
<?php endif; ?>
<section class="mt-4 w-full overflow-auto h-[500px] border-2 border-black">
    <table class="table-auto border-collapse w-screen  text-center">
        <thead class="">
            <tr class="bg-slate-300">
                <th class="p-2 border border-slate-800">Id Tim</th>
                <th class="p-2 border border-slate-800">Nama Tim</th>
                <th class="p-2 border border-slate-800">Jumlah Anggota</th>
                <th class="p-2 border border-slate-800">Nama Ketua</th>
                <th class="p-2 border border-slate-800">Asal Institusi</th>
                <th class="p-2 border border-slate-800">Bidang</th>
                <th class="p-2 border border-slate-800">Email Ketua</th>
                <th class="p-2 border border-slate-800">No WA Ketua</th>
                <th class="p-2 border border-slate-800">Suket Ketua</th>
                <th class="p-2 border border-slate-800">Nama Anggota 1</th>
                <th class="p-2 border border-slate-800">Surket Anggota 1</th>
                <th class="p-2 border border-slate-800">Nama Anggota 2</th>
                <th class="p-2 border border-slate-800">Surket Anggota 2</th>
                <th class="p-2 border border-slate-800">Nama Anggota 3</th>
                <th class="p-2 border border-slate-800">Surket Anggota 3</th>
                <th class="p-2 border border-slate-800">Nama Anggota 4</th>
                <th class="p-2 border border-slate-800">Surket Anggota 4</th>
                <th class="p-2 border border-slate-800">Nama Produk</th>
                <th class="p-2 border border-slate-800">Deskripsi Produk</th>
                <th class="p-2 border border-slate-800">Link Youtube</th>
                <th class="p-2 border border-slate-800">Surat Kontrak</th>
                <th class="p-2 px-4 border border-slate-800">Konfirmasi</th>
            </tr>
            <!-- 21 rows -->
        </thead>
        <tbody>
            <?php foreach ($team_list as $team) : ?>
                <tr>
                    <td class="p-2 border border-slate-300"><?= $team['exploit_tim_id']; ?></td>
                    <td class="p-2 border border-slate-300"><?= $team['exploit_tim_nama']; ?></td>
                    <td class="p-2 border border-slate-300"><?= $team['exploit_jumlah_anggota']; ?></td>
                    <td class="p-2 border border-slate-300"><?= $team['exploit_nama_ketua']; ?></td>
                    <td class="p-2 border border-slate-300"><?= $team['exploit_asal_institusi']; ?></td>
                    <td class="p-2 border border-slate-300"><?= $team['exploit_bidang']; ?></td>
                    <td class="p-2 border border-slate-300"><?= $team['exploit_email']; ?></td>
                    <td class="p-2 border border-slate-300"><?= $team['exploit_phone']; ?></td>
                    <td class="underline text-blue-600 border p-2 border-slate-300"><a href="<?= base_url('uploads/exploit/identitas/' . $team['exploit_suket_ketua']); ?>" target="_blank">Lihat</a></td>

                    <!-- Anggota 1 -->
                    <?php if ($team['exploit_nama_anggota_1']) : ?>
                        <td class="p-2 border border-slate-300"><?= $team['exploit_nama_anggota_1']; ?></td>
                    <?php else : ?>
                        <td class="p-2 border border-slate-300">-</td>
                    <?php endif; ?>
                    <?php if ($team['exploit_suket_anggota_1']) : ?>
                        <td class="underline text-blue-600 border p-2 border-slate-300"><a href="<?= base_url('uploads/exploit/identitas/' . $team['exploit_suket_anggota_1']); ?>" target="_blank">Lihat</a></td>
                    <?php else : ?>
                        <td class="p-2 border border-slate-300">-</td>
                    <?php endif; ?>

                    <!-- Anggota 2 -->
                    <?php if ($team['exploit_nama_anggota_2']) : ?>
                        <td class="p-2 border border-slate-300"><?= $team['exploit_nama_anggota_2']; ?></td>
                    <?php else : ?>
                        <td class="p-2 border border-slate-300">-</td>
                    <?php endif; ?>
                    <?php if ($team['exploit_suket_anggota_2']) : ?>
                        <td class="underline text-blue-600 border p-2 border-slate-300"><a href="<?= base_url('uploads/exploit/identitas/' . $team['exploit_suket_anggota_2']); ?>" target="_blank">Lihat</a></td>
                    <?php else : ?>
                        <td class="p-2 border border-slate-300">-</td>
                    <?php endif; ?>

                    <!-- Anggota 3 -->
                    <?php if ($team['exploit_nama_anggota_3']) : ?>
                        <td class="p-2 border border-slate-300"><?= $team['exploit_nama_anggota_3']; ?></td>
                    <?php else : ?>
                        <td class="p-2 border border-slate-300">-</td>
                    <?php endif; ?>
                    <?php if ($team['exploit_suket_anggota_3']) : ?>
                        <td class="underline text-blue-600 border p-2 border-slate-300"><a href="<?= base_url('uploads/exploit/identitas/' . $team['exploit_suket_anggota_3']); ?>" target="_blank">Lihat</a></td>
                    <?php else : ?>
                        <td class="p-2 border border-slate-300">-</td>
                    <?php endif; ?>

                    <!-- Anggota 4 -->
                    <?php if ($team['exploit_nama_anggota_4']) : ?>
                        <td class="p-2 border border-slate-300"><?= $team['exploit_nama_anggota_4']; ?></td>
                    <?php else : ?>
                        <td class="p-2 border border-slate-300">-</td>
                    <?php endif; ?>
                    <?php if ($team['exploit_suket_anggota_4']) : ?>
                        <td class="underline text-blue-600 border p-2 border-slate-300"><a href="<?= base_url('uploads/exploit/identitas/' . $team['exploit_suket_anggota_4']); ?>" target="_blank">Lihat</a></td>
                    <?php else : ?>
                        <td class="p-2 border border-slate-300">-</td>
                    <?php endif; ?>

                    <td class="p-2 border border-slate-300"><?= $team['exploit_nama_produk']; ?></td>
                    <td class="p-2 border border-slate-300" id="deskripsiProduk<?= $team['exploit_tim_id']; ?>">
                        <?php if (strlen($team['exploit_desk_produk']) > 50) : ?>
                            <?= substr($team['exploit_desk_produk'], 0, 40); ?>
                            <p class="text-blue-600 cursor-pointer" id="showdetailProduk<?= $team['exploit_tim_id']; ?>">
                                More</p>

                            <script>
                                document.querySelector('#deskripsiProduk<?= $team['exploit_tim_id']; ?>').addEventListener('click',
                                    function(e) {
                                        if (e.target.id == 'showdetailProduk<?= $team['exploit_tim_id']; ?>') {
                                            document.getElementById('deskripsiProduk<?= $team['exploit_tim_id']; ?>')
                                                .innerHTML =
                                                '<?= $team['exploit_desk_produk']; ?>' +
                                                '<p class="text-blue-600 cursor-pointer" id="hidedetailProduk<?= $team['exploit_tim_id']; ?>">Hide</p>';
                                        }
                                        if (e.target.id == 'hidedetailProduk<?= $team['exploit_tim_id']; ?>') {
                                            document.getElementById('deskripsiProduk<?= $team['exploit_tim_id']; ?>')
                                                .innerHTML =
                                                '<?= substr($team['exploit_desk_produk'], 0, 40); ?>' +
                                                '<p class="text-blue-600 cursor-pointer" id="showdetailProduk<?= $team['exploit_tim_id']; ?>">More</p>';
                                        }
                                    });
                            </script>

                        <?php else : ?>
                            <?= $team['exploit_desk_produk']; ?>
                        <?php endif; ?>
                    </td>

                    <td class="underline text-blue-600 border p-2 border-slate-300">
                        <a href="<?= prep_url($team['exploit_link_youtube']); ?>" target="_blank">Lihat</a>
                    </td>

                    <td class="underline text-blue-600 border p-2 border-slate-300">
                        <a href="<?= base_url('uploads/exploit/surat_kontrak/' . $team['exploit_surat_kontrak']); ?>" target="_blank">Lihat</a>
                    </td>

                    <td class="p-2 border border-slate-300">
                        <button onclick="return confirm('Terima Tim <?= $team['exploit_tim_nama']; ?>?')"><a class="p-2 border border-black rounded-sm bg-green-500 mr-px" href="<?= base_url() ?>/dashboard/admin-exploit/verify-konfirmasi-team/<?= $team['exploit_tim_id'] ?>/1">Ya</a></button>

                        <button onclick="return confirm('Tolak Tim <?= $team['exploit_tim_nama']; ?>?')"><a class="ml-px p-2 border border-black rounded-sm bg-red-500" href="<?= base_url() ?>/dashboard/admin-exploit/verify-konfirmasi-team/<?= $team['exploit_tim_id'] ?>/0">Tidak</a></button>
                    </td>
                </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
</section>
<?= $this->endSection('content'); ?>